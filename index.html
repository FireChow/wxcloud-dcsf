<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <link rel="shortcut icon"
    href="https://static-index-4gtuqm3bfa95c963-1304825656.tcloudbaseapp.com/official-website/favicon.svg"
    mce_href="https://static-index-4gtuqm3bfa95c963-1304825656.tcloudbaseapp.com/official-website/favicon.svg"
    type="image/x-icon" />
  <meta name="viewport" content="width=650,user-scalable=no" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://weui.io/style/weui.css">
  <title>欢迎注册</title>
  <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
  <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
  <script src="https://web-9gikcbug35bad3a8-1304825656.tcloudbaseapp.com/sdk/1.3.0/cloud.js"></script>
  <script src="https://web-9gikcbug35bad3a8-1304825656.tcloudbaseapp.com/sdk/1.3.1/mplogin.min.js"></script>
  <script>
    let c1;
    window.onload = async function () {
      c1 = new wx.cloud.Cloud({
        identityless: true,
        resourceAppid: 'wx5c88573f4a89192b',
        resourceEnv: 'prod-1gyjb4if1998d9b4',
      })
      await c1.init()
      const callres = await c1.callContainer({
        config: {
          env: 'prod-1gyjb4if1998d9b4', // 微信云托管的环境ID
        },
        path: '/api/wx_openid', // 填入业务自定义路径和参数，根目录，就是 / 
        method: 'GET', // 按照自己的业务开发，选择对应的方法
        header: {
          'X-WX-SERVICE': 'koa-7zry', // xxx中填入服务名称（微信云托管 - 服务管理 - 服务列表 - 服务名称）
          "content-type": "application/json"
        }
        // 其余参数同 wx.request
      })
      console.log(callres)
      if (callres.data) {
        $(".inputs").css("display", "none")
        $(".pay").css("display", "block")
      } else {
        $(".inputs").css("display", "block")
        $(".pay").css("display", "none")
        submitRegister()
      }
    }
    function submitRegister() {
      $('#js_btn').click(async () => {
        let user = {
          name: $("#name").val(),
          id_tems: $("#id_tems").val(),
          email: $("#email").val(),
          phone: $("#phone").val(),
          referee: $("#referee").val()
        }
        console.log(user)
        const callres = await c1.callContainer({
          config: {
            env: 'prod-1gyjb4if1998d9b4', // 微信云托管的环境ID
          },
          path: '/api/user', // 填入业务自定义路径和参数，根目录，就是 / 
          method: 'POST', // 按照自己的业务开发，选择对应的方法
          header: {
            'X-WX-SERVICE': 'koa-7zry', // xxx中填入服务名称（微信云托管 - 服务管理 - 服务列表 - 服务名称）
            "content-type": "application/json"
          },
          data: {
            user
          }
          // 其余参数同 wx.request
        })
        console.log(callres)
        if (callres.data) {
          $(".inputs").css("display", "none")
          $(".pay").css("display", "block")
        } else {
          $(".inputs").css("display", "block")
          $(".pay").css("display", "none")
          submitRegister()
        }
      })
    }
  </script>
</head>

<body>
  <div class="container">
    <div class="page form_page js_show" tabindex="-1">
      <div class="weui-form inputs">
        <div class="weui-form__text-area">
          <h2 class="weui-form__title">注册</h2>
          <div class="weui-form__desc">请输入以下信息进行注册</div>
        </div>
        <div class="weui-form__control-area">
          <div class="weui-cells__group weui-cells__group_form">
            <div class="weui-cells">
              <label for="js_input1" class="weui-cell weui-cell_active">
                <div class="weui-cell__hd"><span class="weui-label">被鉴定对象信息</span></div>
                <div class="weui-cell__bd">
                  <input id="name" class="weui-input" placeholder="填写被鉴定对象信息">
                </div>
              </label>
              <label for="js_input2" class="weui-cell weui-cell_active">
                <div class="weui-cell__hd"><span class="weui-label">鉴定项目</span></div>
                <div class="weui-cell__bd">
                  <input id="id_tems" class="weui-input" placeholder="填写鉴定项目">
                </div>
              </label>
              <label for="js_input2" class="weui-cell weui-cell_active">
                <div class="weui-cell__hd"><span class="weui-label">邮箱</span></div>
                <div class="weui-cell__bd">
                  <input id="email" class="weui-input" placeholder="填写邮箱">
                </div>
              </label>
              <label for="js_input3" class="weui-cell weui-cell_active">
                <div class="weui-cell__hd"><span class="weui-label">联系方式</span></div>
                <div class="weui-cell__bd">
                  <input id="phone" class="weui-input" placeholder="填写联系方式" type="number" pattern="[0-9]*">
                </div>
              </label>
              <label for="js_input2" class="weui-cell weui-cell_active">
                <div class="weui-cell__hd"><span class="weui-label">鉴定人</span></div>
                <div class="weui-cell__bd">
                  <input id="referee" class="weui-input" placeholder="填写鉴定人">
                </div>
              </label>
            </div>
          </div>
        </div>
        <div class="weui-bottom-fixed-opr" id="js_opr">
          <a href="javascript:;" role="button" class="weui-btn weui-btn_primary" id="js_btn">确定</a>
        </div>
      </div>
    </div>
    <div class="page gallery js_show pay" tabindex="-1">
      <div class="page__hd">
        <h1 class="page__title" style="text-align: center;">扫码进行支付</h1>
      </div>
      <div>
        <img style="width: 100%;"
          src="https://7072-prod-1g3ezreeff916953-1311324132.tcb.qcloud.la/WechatIMG15.jpeg?sign=66a4f38ea24f5e7e5aa3c53b7a3d605f&t=1654327290" />
      </div>
    </div>
  </div>
</body>
<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://res.wx.qq.com/t/wx_fed/cdn_libs/res/weui/1.2.8/weui.min.js"></script>
<script>

</script>

</html>